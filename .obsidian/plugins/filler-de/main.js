/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var j=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var xe=Object.prototype.hasOwnProperty;var Ie=(e,n)=>{for(var t in n)j(e,t,{get:n[t],enumerable:!0})},Re=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of Ae(n))!xe.call(e,s)&&s!==t&&j(e,s,{get:()=>n[s],enumerable:!(i=Se(n,s))||i.enumerable});return e};var Ne=e=>Re(j({},"__esModule",{value:!0}),e);var st={};Ie(st,{default:()=>$});module.exports=Ne(st);var m=require("obsidian");var k=require("obsidian"),N=class extends k.PluginSettingTab{constructor(t,i){super(t,i);this.plugin=i}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Settings"}),new k.Setting(t).setName("DeepSeek API Key").setDesc("Won`t leave your vault").addText(i=>i.setPlaceholder("Enter your key").setValue(this.plugin.settings.deepseekApiKey).onChange(async s=>{this.plugin.settings.deepseekApiKey=s,await this.plugin.saveSettings()})),new k.Setting(t).setName("Google API Key").setDesc("Won`t leave your vault").addText(i=>i.setPlaceholder("Enter your key").setValue(this.plugin.settings.googleApiKey).onChange(async s=>{this.plugin.settings.googleApiKey=s,await this.plugin.saveSettings()})),new k.Setting(t).setName("API Provider").setDesc("Choose which API provider to use").addDropdown(i=>{i.addOption("google","Google"),i.addOption("deepseek","DeepSeek"),i.setValue(this.plugin.settings.apiProvider),i.onChange(async s=>{this.plugin.settings.apiProvider=s,await this.plugin.saveSettings()})})}};var X={deepseekApiKey:"",googleApiKey:"",apiProvider:"google"};var Q;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(Q||(Q={}));var ee;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(ee||(ee={}));var te;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(te||(te={}));var ne=["user","model","function","system"],ie;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(ie||(ie={}));var se;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(se||(se={}));var re;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(re||(re={}));var oe;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(oe||(oe={}));var S;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER"})(S||(S={}));var ae;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(ae||(ae={}));var le;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(le||(le={}));var ce;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ce||(ce={}));var h=class extends Error{constructor(n){super(`[GoogleGenerativeAI Error]: ${n}`)}},v=class extends h{constructor(n,t){super(n),this.response=t}},O=class extends h{constructor(n,t,i,s){super(n),this.status=t,this.statusText=i,this.errorDetails=s}},p=class extends h{};var Te="https://generativelanguage.googleapis.com",Oe="v1beta",ze="0.21.0",Fe="genai-js",_;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(_||(_={}));var H=class{constructor(n,t,i,s,r){this.model=n,this.task=t,this.apiKey=i,this.stream=s,this.requestOptions=r}toString(){var n,t;let i=((n=this.requestOptions)===null||n===void 0?void 0:n.apiVersion)||Oe,r=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||Te}/${i}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}};function De(e){let n=[];return e!=null&&e.apiClient&&n.push(e.apiClient),n.push(`${Fe}/${ze}`),n.join(" ")}async function Me(e){var n;let t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",De(e.requestOptions)),t.append("x-goog-api-key",e.apiKey);let i=(n=e.requestOptions)===null||n===void 0?void 0:n.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(s){throw new p(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${s.message}`)}for(let[s,r]of i.entries()){if(s==="x-goog-api-key")throw new p(`Cannot set reserved header name ${s}`);if(s==="x-goog-api-client")throw new p(`Header name ${s} can only be set using the apiClient field`);t.append(s,r)}}return t}async function Pe(e,n,t,i,s,r){let o=new H(e,n,t,i,r);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},je(r)),{method:"POST",headers:await Me(o),body:s})}}async function R(e,n,t,i,s,r={},o=fetch){let{url:a,fetchOptions:c}=await Pe(e,n,t,i,s,r);return Ge(a,c,o)}async function Ge(e,n,t=fetch){let i;try{i=await t(e,n)}catch(s){$e(s,e)}return i.ok||await Le(i,e),i}function $e(e,n){let t=e;throw e instanceof O||e instanceof p||(t=new h(`Error fetching from ${n.toString()}: ${e.message}`),t.stack=e.stack),t}async function Le(e,n){let t="",i;try{let s=await e.json();t=s.error.message,s.error.details&&(t+=` ${JSON.stringify(s.error.details)}`,i=s.error.details)}catch(s){}throw new O(`Error fetching from ${n.toString()}: [${e.status} ${e.statusText}] ${t}`,e.status,e.statusText,i)}function je(e){let n={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){let t=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>t.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{t.abort()}),n.signal=t.signal}return n}function K(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),T(e.candidates[0]))throw new v(`${E(e)}`,e);return He(e)}else if(e.promptFeedback)throw new v(`Text not available. ${E(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),T(e.candidates[0]))throw new v(`${E(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),de(e)[0]}else if(e.promptFeedback)throw new v(`Function call not available. ${E(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),T(e.candidates[0]))throw new v(`${E(e)}`,e);return de(e)}else if(e.promptFeedback)throw new v(`Function call not available. ${E(e)}`,e)},e}function He(e){var n,t,i,s;let r=[];if(!((t=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||t===void 0)&&t.parts)for(let o of(s=(i=e.candidates)===null||i===void 0?void 0:i[0].content)===null||s===void 0?void 0:s.parts)o.text&&r.push(o.text),o.executableCode&&r.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&r.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function de(e){var n,t,i,s;let r=[];if(!((t=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||t===void 0)&&t.parts)for(let o of(s=(i=e.candidates)===null||i===void 0?void 0:i[0].content)===null||s===void 0?void 0:s.parts)o.functionCall&&r.push(o.functionCall);if(r.length>0)return r}var Be=[S.RECITATION,S.SAFETY,S.LANGUAGE];function T(e){return!!e.finishReason&&Be.includes(e.finishReason)}function E(e){var n,t,i;let s="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)s+="Response was blocked",!((n=e.promptFeedback)===null||n===void 0)&&n.blockReason&&(s+=` due to ${e.promptFeedback.blockReason}`),!((t=e.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(s+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((i=e.candidates)===null||i===void 0)&&i[0]){let r=e.candidates[0];T(r)&&(s+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(s+=`: ${r.finishMessage}`))}return s}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function Ke(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(e,n||[]),s,r=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){i[d]&&(s[d]=function(l){return new Promise(function(g,y){r.push([d,l,g,y])>1||a(d,l)})})}function a(d,l){try{c(i[d](l))}catch(g){w(r[0][3],g)}}function c(d){d.value instanceof A?Promise.resolve(d.value.v).then(u,f):w(r[0][2],d)}function u(d){a("next",d)}function f(d){a("throw",d)}function w(d,l){d(l),r.shift(),r.length&&a(r[0][0],r[0][1])}}var ue=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Ue(e){let n=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=qe(n),[i,s]=t.tee();return{stream:Ye(i),response:Ve(s)}}async function Ve(e){let n=[],t=e.getReader();for(;;){let{done:i,value:s}=await t.read();if(i)return K(We(n));n.push(s)}}function Ye(e){return Ke(this,arguments,function*(){let t=e.getReader();for(;;){let{value:i,done:s}=yield A(t.read());if(s)break;yield yield A(K(i))}})}function qe(e){let n=e.getReader();return new ReadableStream({start(i){let s="";return r();function r(){return n.read().then(({value:o,done:a})=>{if(a){if(s.trim()){i.error(new h("Failed to parse stream"));return}i.close();return}s+=o;let c=s.match(ue),u;for(;c;){try{u=JSON.parse(c[1])}catch(f){i.error(new h(`Error parsing JSON response: "${c[1]}"`));return}i.enqueue(u),s=s.substring(c[0].length),c=s.match(ue)}return r()})}}})}function We(e){let n=e[e.length-1],t={promptFeedback:n==null?void 0:n.promptFeedback};for(let i of e){if(i.candidates)for(let s of i.candidates){let r=s.index;if(t.candidates||(t.candidates=[]),t.candidates[r]||(t.candidates[r]={index:s.index}),t.candidates[r].citationMetadata=s.citationMetadata,t.candidates[r].groundingMetadata=s.groundingMetadata,t.candidates[r].finishReason=s.finishReason,t.candidates[r].finishMessage=s.finishMessage,t.candidates[r].safetyRatings=s.safetyRatings,s.content&&s.content.parts){t.candidates[r].content||(t.candidates[r].content={role:s.content.role||"user",parts:[]});let o={};for(let a of s.content.parts)a.text&&(o.text=a.text),a.functionCall&&(o.functionCall=a.functionCall),a.executableCode&&(o.executableCode=a.executableCode),a.codeExecutionResult&&(o.codeExecutionResult=a.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),t.candidates[r].content.parts.push(o)}}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}async function pe(e,n,t,i){let s=await R(n,_.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(t),i);return Ue(s)}async function me(e,n,t,i){let r=await(await R(n,_.GENERATE_CONTENT,e,!1,JSON.stringify(t),i)).json();return{response:K(r)}}function we(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function x(e){let n=[];if(typeof e=="string")n=[{text:e}];else for(let t of e)typeof t=="string"?n.push({text:t}):n.push(t);return Je(n)}function Je(e){let n={role:"user",parts:[]},t={role:"function",parts:[]},i=!1,s=!1;for(let r of e)"functionResponse"in r?(t.parts.push(r),s=!0):(n.parts.push(r),i=!0);if(i&&s)throw new h("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!s)throw new h("No content is provided for sending chat message.");return i?n:t}function Ze(e,n){var t;let i={model:n==null?void 0:n.model,generationConfig:n==null?void 0:n.generationConfig,safetySettings:n==null?void 0:n.safetySettings,tools:n==null?void 0:n.tools,toolConfig:n==null?void 0:n.toolConfig,systemInstruction:n==null?void 0:n.systemInstruction,cachedContent:(t=n==null?void 0:n.cachedContent)===null||t===void 0?void 0:t.name,contents:[]},s=e.generateContentRequest!=null;if(e.contents){if(s)throw new p("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=e.contents}else if(s)i=Object.assign(Object.assign({},i),e.generateContentRequest);else{let r=x(e);i.contents=[r]}return{generateContentRequest:i}}function ge(e){let n;return e.contents?n=e:n={contents:[x(e)]},e.systemInstruction&&(n.systemInstruction=we(e.systemInstruction)),n}function Xe(e){return typeof e=="string"||Array.isArray(e)?{content:x(e)}:e}var he=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Qe={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function et(e){let n=!1;for(let t of e){let{role:i,parts:s}=t;if(!n&&i!=="user")throw new h(`First content should be with role 'user', got ${i}`);if(!ne.includes(i))throw new h(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(ne)}`);if(!Array.isArray(s))throw new h("Content should have 'parts' property with an array of Parts");if(s.length===0)throw new h("Each Content should have at least one part");let r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let a of s)for(let c of he)c in a&&(r[c]+=1);let o=Qe[i];for(let a of he)if(!o.includes(a)&&r[a]>0)throw new h(`Content with role '${i}' can't contain '${a}' part`);n=!0}}var fe="SILENT_ERROR",B=class{constructor(n,t,i,s={}){this.model=t,this.params=i,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=n,i!=null&&i.history&&(et(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(n,t={}){var i,s,r,o,a,c;await this._sendPromise;let u=x(n),f={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,u]},w=Object.assign(Object.assign({},this._requestOptions),t),d;return this._sendPromise=this._sendPromise.then(()=>me(this._apiKey,this.model,f,w)).then(l=>{var g;if(l.response.candidates&&l.response.candidates.length>0){this._history.push(u);let y=Object.assign({parts:[],role:"model"},(g=l.response.candidates)===null||g===void 0?void 0:g[0].content);this._history.push(y)}else{let y=E(l.response);y&&console.warn(`sendMessage() was unsuccessful. ${y}. Inspect response object for details.`)}d=l}),await this._sendPromise,d}async sendMessageStream(n,t={}){var i,s,r,o,a,c;await this._sendPromise;let u=x(n),f={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,u]},w=Object.assign(Object.assign({},this._requestOptions),t),d=pe(this._apiKey,this.model,f,w);return this._sendPromise=this._sendPromise.then(()=>d).catch(l=>{throw new Error(fe)}).then(l=>l.response).then(l=>{if(l.candidates&&l.candidates.length>0){this._history.push(u);let g=Object.assign({},l.candidates[0].content);g.role||(g.role="model"),this._history.push(g)}else{let g=E(l);g&&console.warn(`sendMessageStream() was unsuccessful. ${g}. Inspect response object for details.`)}}).catch(l=>{l.message!==fe&&console.error(l)}),d}};async function tt(e,n,t,i){return(await R(n,_.COUNT_TOKENS,e,!1,JSON.stringify(t),i)).json()}async function nt(e,n,t,i){return(await R(n,_.EMBED_CONTENT,e,!1,JSON.stringify(t),i)).json()}async function it(e,n,t,i){let s=t.requests.map(o=>Object.assign(Object.assign({},o),{model:n}));return(await R(n,_.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:s}),i)).json()}var z=class{constructor(n,t,i={}){this.apiKey=n,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=we(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(n,t={}){var i;let s=ge(n),r=Object.assign(Object.assign({},this._requestOptions),t);return me(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},s),r)}async generateContentStream(n,t={}){var i;let s=ge(n),r=Object.assign(Object.assign({},this._requestOptions),t);return pe(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},s),r)}startChat(n){var t;return new B(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},n),this._requestOptions)}async countTokens(n,t={}){let i=Ze(n,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),t);return tt(this.apiKey,this.model,i,s)}async embedContent(n,t={}){let i=Xe(n),s=Object.assign(Object.assign({},this._requestOptions),t);return nt(this.apiKey,this.model,i,s)}async batchEmbedContents(n,t={}){let i=Object.assign(Object.assign({},this._requestOptions),t);return it(this.apiKey,this.model,n,i)}};var I=class{constructor(n){this.apiKey=n}getGenerativeModel(n,t){if(!n.model)throw new h("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new z(this.apiKey,n,t)}getGenerativeModelFromCachedContent(n,t,i){if(!n.name)throw new p("Cached content must contain a `name` field.");if(!n.model)throw new p("Cached content must contain a `model` field.");let s=["model","systemInstruction"];for(let o of s)if(t!=null&&t[o]&&n[o]&&(t==null?void 0:t[o])!==n[o]){if(o==="model"){let a=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,c=n.model.startsWith("models/")?n.model.replace("models/",""):n.model;if(a===c)continue}throw new p(`Different value for "${o}" specified in modelParams (${t[o]}) and cachedContent (${n[o]})`)}let r=Object.assign(Object.assign({},t),{model:n.model,tools:n.tools,toolConfig:n.toolConfig,systemInstruction:n.systemInstruction,cachedContent:n});return new z(this.apiKey,r,i)}};var ve=require("obsidian");var C={generate_dictionary_entry:`You are an expert linguist specializing in the German language. Your task is to create a detailed dictionary entry for a given German word. Here's the word you need to analyze:
<german_word>
{{german_word}}
</german_word>

Before creating the entry, analyze the word and plan your approach. Break down the word inside <word_breakdown> tags:

1. Identify the part of speech of the word.
2. If it's a verb:
- Determine if it's trennbar (separable) or untrennbar (inseparable).
- Identify its tense forms (present, past, perfect).
- Note any irregular conjugations. -Fill the list of cojugations (Pr\xE4sens, Pr\xE4teritum, Imperativ, Konjunktiv I, Konjunktiv II) 
3. For nouns:
- Identify the gender (masculine, feminine, or neuter).
- Determine the declension pattern.
4. For adjectives:
- Note the comparative and superlative forms.
5. Identify and list examples of each morpheme in the word.
6. Plan which template you'll use based on the part of speech.
7. List the key information you'll need to include in the entry (e.g., pronunciation, conjugations, synonyms, antonyms, translations, morphemes).

It's OK for this section to be quite long.

Now, create the dictionary entry using the appropriate template based on your analysis. Strictly adhere to the format provided in the examples, ensuring no additional text is included that isn't present in the templates. Use the following guidelines:

1. For trennbar verbs:
- Start with an appropriate emoji
- Include pronunciation, conjugations, synonyms, antonyms, English and Russian translations, morpheme breakdown, and a conjugation table

2. For untrennbar verbs and verbs without prefixes:
- Follow a similar format to trennbar verbs, adjusting the conjugation details as needed

3. For adjectives:
- Start with an appropriate emoji
- Include pronunciation, antonyms, synonyms, English and Russian translations, and unique possible forms

4. For nouns:
- Use \u{1F534} for feminine, \u{1F7E2} for neuter, and \u{1F535} for masculine nouns
- Include plural form, synonyms, English and Russian translations, morpheme breakdown, and unique possible forms

5. For other parts of speech:
- Create a similar template, adapting the information as appropriate for the specific part of speech

Present only your final entry. Do not present the user with word_breakdown. Do not write to the user your thought process.
<examples>
<example>
<german_word>
verfeinden
</german_word>
<ideal_output>
\u{1F624} [[verfeinden]], [f\u025B\u0250\u032F\u02C8fa\u026A\u032Fndn\u0329] | [[verfeindete]], haben [[verfeindet]]

---


---
= [[zerstreiten]], [[entzweien]]
\u2248 Feindschaft  [[schlie\xDFen]], [[verkrachen]], in Konflikt [[geraten]]
\u2260 [[vers\xF6hnen]], [[vertragen]], [[anfreunden]]

---
to make enemies, to set at odds
\u043F\u043E\u0441\u0441\u043E\u0440\u0438\u0442\u044C, \u0441\u0434\u0435\u043B\u0430\u0442\u044C \u0432\u0440\u0430\u0433\u0430\u043C\u0438

---
[[ver]]|[[fein]]|[den]]

---
ich: [[verfeinde]], [[verfeindete]], \u2013, [[verfeinde]], [[verfeindete]]
du: [[verfeindest]], [[verfeindetest]], [[verfeinde]] | [[verfeind]] | [[verfeinde]], [[verfeindest]], [[verfeindetest]]
er/sie/es: [[verfeindet]], [[verfeindete]], \u2013, [[verfeinde]], [[verfeindete]]
wir: [[verfeinden]], [[verfeindeten]], [[verfeinden wir|verfeinden]], [[verfeinden]], [[verfeindeten]]
ihr: [[verfeindet]], [[verfeindetet]], [[verfeindet]], [[verfeindet]], [[verfeindetet]] 

PI: [[verfeindend]], PII: [[verfeindet]], Zu+inf: [[zuverfeinden]]

---
[[verfeinden]] - [[ver]] = [[feinden]] / to make enemies, to set at odds

---
[[Verfehndung]], [[Verfeindung]], [[Feind]], [[feindlich]], [[Feindschaft]]

</ideal_output>
</example>

<example>
<german_word>
tanztest
</german_word>
<ideal_output>
\u{1F483} [[tanzen]], [\u02C8tan\u02A6n\u0329] | [[tanzte]], haben [[getanzt]]

---

---
= [[sich bewegen]], [[schwofen]], [[abhotten]]
\u2248 [[wiegen]], [[sich drehen]], [[h\xFCpfen]], [[ballettieren]]
\u2260 [[sitzen]], [[stehen]], [[verharren]], [[ruhen]]

---
to dance
\u0442\u0430\u043D\u0446\u0435\u0432\u0430\u0442\u044C

---
[[tanz]]|[[en]]

---
ich: [[tanze]], [[tanzte]], \u2013, [[tanze]], [[tanzte]]
du: [[tanzt]], [[tanzt]], [[tanze]] | [[tanz]], [[tanzt]], [[tanztest]]
er/sie/es: [[tanzt]], [[tanzte]], \u2013, [[tanze]], [[tanzte]]
wir: [[tanzen]], [[tanzten]], [[tanzen wir|tanzen]], [[tanzen]], [[tanzten]]
ihr: [[tanzt]], [[tanztet]], [[tanzt]], [[tanzt]], [[tanztet]]

PI: [[tanzend]], PII: [[getanzt]], Zu+inf: [[zu tanzen]]

---

---
[[Tanz]], [[T\xE4nzer]], [[T\xE4nzerin]], [[Tanzfl\xE4che]], [[tanzerisch]], [[Tanzkurs]]
</ideal_output>
</example>

<example>
<german_word>
Hoffnung
</german_word>
<ideal_output>
\u{1F534} \u{1F54A}\uFE0F die [[Hoffnung]], [\u02C8h\u0254fn\u028A\u014B]
die [[Hoffnungen]]

---


---
= [[Zuversicht]], [[Optimismus]]
\u2248 [[Erwartung]], [[Vertrauen]], [[Glaube]], [[Wunsch]]
\u2260 [[Verzweiflung]], [[Pessimismus]], [[Hoffnungslosigkeit]], [[Resignation]]

---
hope
\u043D\u0430\u0434\u0435\u0436\u0434\u0430

---
[[Hoff]]|[[nung]]

---
N: die [[Hoffnung]], die [[Hoffnungen]]  
A: die [[Hoffnung]], die [[Hoffnungen]]  
G: der [[Hoffnung]], der [[Hoffnungen]]  
D: der [[Hoffnung]], den [[Hoffnungen]]  

---
[[hoffen]], [[hoffentlich]], [[hoffnungsvoll]], [[hoffnungslos]]
</ideal_output>
</example>

<example>
<german_word>
Busch
</german_word>
<ideal_output>
\u{1F535} \u{1F333} der [[Busch]]
die [[B\\xFCsche]]

---


---
= [[Strauch]], [[Gestr\xE4uch]]
\u2248 [[Geb\xFCsch]], [[Hecke]], [[Geh\xF6lz]]
\u2260 [[Baum]], [[Wiese]], [[Ackerland]], [[\xD6dland]]

---
bush, shrub
\u043A\u0443\u0441\u0442

---
[[Busch]]

---
N: der [[Busch]], die [[B\xFCsche]]  
A: den [[Busch]], die [[B\xFCsche]]  
G: des [[Busches]], der [[B\xFCsche]]  
D: dem [[Busch]], den [[B\xFCschen]] 

---
buschig, buschieren
</ideal_output>
</example>

<example>
<german_word>
klein
</german_word>
<ideal_output>
\u{1F42D} [[klein]], [\\u02C8kla\\u026A\\u032Fn] \u2260 [[gro\\xDF]]

---


---
= [[kompakt]], [[winzig]], [[gering]]
\u2248 [[niedrig]], [[schmal]], [[zierlich]], [[zart]], [[begrenzt]]
\u2260 [[gro\xDF]], [[riesig]], [[weit]], [[breit]]

---
small, little
\u043C\u0430\u043B\u0435\u043D\u044C\u043A\u0438\u0439

---
[[klein]]

---
N: [[klein]], [[kleiner]], [[kleinster]]  
A: [[kleinen]], [[kleineren]], [[kleinsten]]  
G: [[kleiner]], [[kleinerer]], [[kleinster]]  
D: [[kleinem]], [[kleinerem]], [[kleinstem]]  
F: [[kleine]], [[kleinere]], [[kleinste]]  
N: [[kleines]], [[kleineres]], [[kleinstes]]  
P: [[kleinen]], [[kleineren]], [[kleinsten]]  

---
[[Kleinheit]], [[kleinlich]], [[kleinmachen]]
</ideal_output>
</example>
<example>
<german_word>
anzurufen
</german_word>
<ideal_output>
\u{1F4DE} [[anrufen]], [\u02C8an\u02A6u\u02CC\u0281u\u02D0f\u0259n] | [[rief an]], haben [[angerufen]]

---


---
= [[telefonieren]], [[kontaktieren]], [[anklingeln]]
\u2248 [[sich melden]], [[Kontakt aufnehmen]], [[durchklingeln]]
\u2260 [[ignorieren]], [[ablehnen]], [[auflegen]], [[beenden]]

---
to call, to phone
\u0437\u0432\u043E\u043D\u0438\u0442\u044C 

---
[[an]]|[[ru]]|[[fen]]

---
ich: [[rufe an]], [[rief an]], \u2013, [[rufe an]], [[riefe an]]
du: [[rufst an]], [[riefst an]], [[rufe an]] | [[ruf an]], [[rufest an]], [[riefest an]]
er/sie/es: [[ruft an]], [[rief an]], \u2013, [[rufe an]], [[riefe an]]
wir: [[rufen an]], [[riefen an]], [[rufen wir an|rufen an]], [[rufen an]], [[riefen an]]
ihr: [[ruft an]], [[rieft an]], [[ruft an]], [[rufet an]], [[riefet an]]

PI: [[anrufend]], PII: [[angerufen]], Zu+inf: [[anzurufen]]

---
[[anrufen]] - [[an]] = [[rufen]] / to call, to phone

---
[[Anruf]], [[Anrufer]], [[Anruferin]], [[anrufbar]], [[Anrufbeantworter]]
</ideal_output>
</example>
<example>
<german_word>
st\xE4ndigen
</german_word>
<ideal_output>
\u{1F570}\uFE0F [[st\xE4ndig]], [\u02C8\u0283t\u025Bnd\u026A\xE7] \u2260 [[selten]]

---


---
= [[fortw\xE4hrend]], [[dauerhaft]], [[andauernd]]
\u2248 [[permanent]], [[kontinuierlich]], [[best\xE4ndig]], [[ununterbrochen]], [[pausenlos]]
\u2260 [[selten]], [[gelegentlich]], [[unregelm\xE4\xDFig]], [[sporadisch]]

---
constantly, continuously, persistently, perpetually
\u043F\u043E\u0441\u0442\u043E\u044F\u043D\u043D\u044B\u0439, \u043D\u0435\u043F\u0440\u0435\u0440\u044B\u0432\u043D\u044B\u0439, \u0431\u0435\u0441\u043F\u0440\u0435\u0441\u0442\u0430\u043D\u043D\u044B\u0439

---
[[st\xE4n]]|[[dig]]

---
N: [[st\xE4ndig]], [[st\xE4ndiger]], [[st\xE4ndigster]]  
A: [[st\xE4ndigen]], [[st\xE4ndigeren]], [[st\xE4ndigsten]]  
G: [[st\xE4ndigen]], [[st\xE4ndigeren]], [[st\xE4ndigsten]]  
D: [[st\xE4ndigem]], [[st\xE4ndigeren]], [[st\xE4ndigstem]]  
F: [[st\xE4ndige]], [[st\xE4ndigere]], [[st\xE4ndigste]]  
N: [[st\xE4ndiges]], [[st\xE4ndigeres]], [[st\xE4ndigstes]]  
P: [[st\xE4ndigen]], [[st\xE4ndigeren]], [[st\xE4ndigsten]]  

---
[[stehen]], [[St\xE4ndigkeit]], [[zust\xE4ndig]], [[anst\xE4ndig]], [[best\xE4ndig]], [[aufst\xE4ndig]]
</ideal_output>
</example>

<example>
<german_word>
zweiteres
</german_word>
<ideal_output>
2\uFE0F\u20E3 [[zwei]], [t\u0361sva\u026A\u032F]  

---

---
= [[doppelt]], [[beide]], [[paar]]  
\u2248 [[ein paar]], [[mehrere]], [[einige]]  
\u2260 [[eins]], [[drei]], [[keiner]]  

---
two  
\u0434\u0432\u0430  

---
[[zwei]]  

---
N: [[zwei]]  
A: [[zwei]]  
G: [[zweier]]  
D: [[zweien]]  

---
\u{1F4CF} **Konjugierte Ordinalzahlen**  
N: [[zweite]], [[zweiter]], [[zweites]], [[zweiten]]  
A: [[zweiten]], [[zweiteren]], [[zweiten]]  
G: [[zweiten]], [[zweiterer]], [[zweiten]]  
D: [[zweitem]], [[zweiterem]], [[zweiten]]  
F: [[zweite]], [[zweitere]], [[zweiteste]]  
N: [[zweites]], [[zweiteres]], [[zweitestes]]  
P: [[zweiten]], [[zweiteren]], [[zweitesten]]  

---
\u{1F4CA} **Konjugierte Indefinitzahlen** *(if applicable)*  
(none for zwei)  

---
[[zweitens]], [[zweifach]], [[zwilling]], [[zweierlei]], [[zweiundzwanzig]], [[der Zweite]], [[zweitweise]], [[zweimalig]]
</ideal_output>
</example>


<example>
<german_word>
einzigsten
</german_word>
<ideal_output>
1\uFE0F\u20E3 [[eins]], [a\u026A\u032Fns] | [[ein]], [a\u026A\u032Fn]  

---
= [[einziger]], [[einer]], [[einmal]]  
\u2248 [[gewisser]], [[irgendein]], [[ein paar]]  
\u2260 [[null]], [[zwei]], [[kein]]  

---
one, a/an, single  
\u043E\u0434\u0438\u043D, \u043D\u0435\u043A\u0438\u0439, \u043A\u0430\u043A\u043E\u0439-\u0442\u043E  

---
[[ein]]  

---
N: [[ein]], [[eins]]  
A: [[ein]]  
G: [[eines]]  
D: [[einem]]  

---
\u{1F4CF} **Konjugierte Ordinalzahlen**  
N: [[erste]], [[erster]], [[erstes]], [[ersten]]  
A: [[ersten]], [[ersteren]], [[ersten]]  
G: [[ersten]], [[ersterer]], [[ersten]]  
D: [[erstem]], [[ersterem]], [[ersten]]  
F: [[erste]], [[erstere]], [[ersteste]]  
N: [[erstes]], [[ersteres]], [[erstestes]]  
P: [[ersten]], [[ersteren]], [[erstesten]]  

---
\u{1F4CA} **Konjugierte Indefinitzahlen**  
N: [[einige]], [[einer]], [[einziges]], [[einigen]]  
A: [[einigen]], [[einiger]], [[einzigsten]]  
G: [[einiger]], [[einigerer]], [[einzigster]]  
D: [[einigem]], [[einigerem]], [[einzigstem]]  
F: [[einige]], [[einige]], [[einzigste]]  
N: [[einiges]], [[einigeres]], [[einzigstes]]  
P: [[einigen]], [[einigeren]], [[einzigsten]]  

---
[[einmal]], [[einzig]], [[einer]], [[einige]], [[erstens]], [[einheit]], [[einzel]], [[einzigartig]], [[einmalig]]
</ideal_output>
</example>

<example>
<german_word>
traurig
</german_word>
<ideal_output>
\u{1F622} [[traurig]], [\u02C8t\u0281a\u028A\u032F\u0281\u026A\xE7]
nicht [[fr\xF6hlich]]

---


---
= [[betr\xFCbt]], [[bek\xFCmmert]], [[niedergeschlagen]]
\u2248 [[melancholisch]], [[wehm\xFCtig]], [[bedr\xFCckt]]
\u2260 [[fr\xF6hlich]], [[gl\xFCcklich]], [[heiter]], [[vergn\xFCgt]]

---
sad, sorrowful
\u0433\u0440\u0443\u0441\u0442\u043D\u044B\u0439, \u043F\u0435\u0447\u0430\u043B\u044C\u043D\u044B\u0439

---
[[trau]]|[[rig]]

---
N: [[traurig]], [[trauriger]], [[traurigster]]  
A: [[traurigen]], [[traurigeren]], [[traurigsten]]  
G: [[trauriger]], [[traurigerer]], [[traurigster]]  
D: [[traurigem]], [[traurigerem]], [[traurigstem]]  
F: [[traurige]], [[traurigere]], [[traurigste]]  
N: [[trauriges]], [[traurigeres]], [[traurigstes]]  
P: [[traurigen]], [[traurigeren]], [[traurigsten]]  

---
[[Trauer]], [[trauern]], [[Traurigkeit]], [[betrauern]], [[trauernd]]
</ideal_output>
</example>
<example>
<german_word>
obwohl
</german_word>
<ideal_output>
\u{1F517} [[obwohl]], [\u0254p\u02C8vo\u02D0l]

---


---
= [[obgleich]], [[wenngleich]], [[obschon]]
\u2248 [[dennoch]], [[gleichwohl]], [[trotzdem]], [[nichtsdestotrotz]]
\u2260 [[weil]], [[denn]], [[deshalb]], [[daher]]

---
although, even though, despite
\u0445\u043E\u0442\u044F, \u043D\u0435 \u0441\u043C\u043E\u0442\u0440\u044F \u043D\u0430 

---
[[ob]]|[[wohl]]

---
[[trotz]], [[obschon]], [[obzwar]], [[wiewohl]], [[obgleich]]
</ideal_output>
</example>
<example>
<german_word>
Rechercheergebnisse
</german_word>
<ideal_output>
\u{1F7E2} \u{1F4C4} das [[Rechercheergbenis]], [re\u02C8\u0283\u025Br\u0283\u0259\u0294\u025B\u0250\u032F\u0261e\u02D0pn\u026As]
die [[Rechercheergbnisse]]

---


---
= [[Untersuchungsergebnis]], [[Forschungsergebnis]]
\u2248 [[Ergebnis]], [[Resultate]], [[Erkenntnisse]], [[Befund]]
\u2260 [[Hypothese]], [[Vermutung]], [[Spekulation]]

---
research result, findings
\u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B \u0438\u0441\u0441\u043B\u0435\u0434\u043E\u0432\u0430\u043D\u0438\u044F

---
[[Recher\xADche]]+[[ergeb\xADnis]]
[[Re]]|[[cher]]|[[che]]|[[er]]|[[geb]]|[[nis]]

---
N: das [[Rechercheergbenis]], die [[Rechercheergbnisse]]  
A: das [[Rechercheergbenis]], die [[Rechercheergbnisse]]  
G: des [[Rechercheergbnis\xADses]], der [[Rechercheergbnisse]]  
D: dem [[Rechercheergbnis]], den [[Rechercheergbnissen]]  

---
[[recherchieren]], [[Recherche]], [[ergebnisorientiert]], [[Forschung]]
</ideal_output>
</example>
</examples>
`,determine_infinitive_and_pick_emoji:`Given a german word, determine its infinitive form and pick an appropriate emoji to represent it. If the word is a noun, determin it's gender and use \u{1F535} for der,  \u{1F534} for die, if \u{1F7E2} for das. Do not write anything else, just the infinitive and an emoji. given "brutzelt" reply with "\u{1F373} [[brutzeln]]". Given "gesorgt" reply with "\u{1F914} [[sorgen]]". Given "Hoffnungen" reply with "\u{1F534} die [[Hoffnung]] \u{1F54A}\uFE0F". Given "eisigen", reply with "\u{1F976} [[eisig]]". If a word can be a form of multiple parts of speach, list all options, separated with |. For expample, given "vergangene", reply with "\u{1F570}\uFE0F [[vergangen]] | \u{1F570}\uFE0F [[vergehen]]". Given "Nieser", reply with "\u{1F927} [[niesen]] | \u{1F535} der [[Nieser]] \u{1F927}". Given "klares", reply with "\u{1F60C} [[kl\xE4ren]] | \u{1F60C} [[klar]] | \u{1F7E2} das [[Klare]] \u{1F60C}. Given "zweiteste", reply with "2\uFE0F\u20E3 [[zwei]]". The output should be compact, without extra spaces or newlines.`,make_brackets:`Process the given German text and generate output following these rules:

For verbs:
a. If the verb is in its basic form (infinitive), enclose it in double square brackets: [[infinitive]]
b. If the verb is not in its basic form, use this format: [[infinitive|encountered form]]
b. If the verb is trenbarren, add the prefix to the infinitive: [[prefixed infinitive|encountered form]]
For nouns:
a. If the noun is singular, enclose it in double square brackets: [[singular form]]
b. If the noun is plural, use this format: [[singular form|plural form]]
For adjectives:
a. If the adjective is in its basic form, enclose it in double square brackets: [[basic form]]
b. If the adjective is not in its basic form, use this format: [[basic form|encountered form]]
Ignore haben/sein, articles (definite and indefinite), names, proper nouns and pronomen

<example>
Der flei\xDFige Student f\xE4ngt an, das schwierige Buch zu lesen, das sein Lehrer empfohlen hat.
Der [[flei\xDFig|flei\xDFige]] [[Student]] [[anfangen|f\xE4ngt]] an, das [[schwierig|schwierige]] [[Buch]] zu [[lesen]], das sein [[Lehrer]] [[empfehlen|empfohlen]] hat.
</example>

<example>
(Schubst Sokka weg) Genau, er ist bestimmt ein Spion der Feuermarine! Das sieht man schon an dem furchtbar b\xF6sen Blick in seinen Augen!
([[wegschubsen|Schubst]] [[schubsen|Sokka]] weg) Genau, er ist [[bestimmt]] ein [[Spion]] der [[Feuermarine]]! Das [[sehen|sieht]] man [[schon]] an dem [[furchtbar|furchtbare]] [[b\xF6se|b\xF6sen]] [[Blick]] in seinen [[Auge|Augen]]!
</example>

<example>
Keine Angst. Mit Wasser kriegt man das wieder ab. Und, wohnt ihr hier in der Gegend?
Keine [[Angst]]. Mit [[Wasser]] [[abkriegen|kriegt]] man das wieder ab. Und, [[wohnen|wohnt]] ihr hier in der [[Gegend]]?
</example>

<example>
und ri\xDF ihnen die Fl\xFCgel aus.  
und [[ausrei\xDFen|ri\xDF]] ihnen die [[Fl\xFCgel]] aus.
</example>

<example>
Er schlug die St\xFChl und V\xF6gel tot,  
Er [[totschlagen|schlug]] die [[Stuhl|St\xFChl]] und [[Vogel|V\xF6gel]] tot,
<example>


The output should only contain the processed text, without explanations or additional content. Ensure grammatical accuracy in the final output.
`,translate_text:`Translate the given German text to English. The translation should be staying true to the original meaning. When possible, mimic german sentance structure. Only provide the translation, no explanations or additional content.

<example>
input:
Der flei\xDFige Student f\xE4ngt an, das schwierige Buch zu lesen.
output:
The diligent student begins the difficult book to read.
</example>

<example>
input:
Keine Angst. Mit Wasser kriegt man das wieder ab.
output:
No worry. With water can one wash it off.
</example>`,translate_ru_to_de:`You are a German language expert. Translate the given Russian text to grammatically correct German, maintaining the original meaning and using natural German expressions.

<example>
input:
\u041E\u043D\u0430 \u0440\u0430\u0441\u0441\u043A\u0430\u0437\u0430\u043B\u0430, \u0447\u0442\u043E \u0435\u0451 \u043C\u0443\u0436 \u0443\u0435\u0445\u0430\u043B \u0432 \u0411\u0435\u0440\u043B\u0438\u043D \u043D\u0430 \u043C\u0430\u0448\u0438\u043D\u0435
output:
Sie erz\xE4hlte, dass ihr Mann mit dem Auto nach Berlin gefahren ist
</example>

Translate the following text:`,check_ru_de_translation:`**Eingabe:** Der Agent erh\xE4lt Texteingaben in einem der folgenden Formate:

1. **Deutsch (DE):** Eine Textzeichenfolge in deutscher Sprache.
2. **Russisch (RU):** Eine Textzeichenfolge in russischer Sprache.
3. **Russisch und Deutsch (RU & DE):** Zwei Textzeichenfolgen, wobei der Agent davon ausgehen soll, dass der russische Text eine \xDCbersetzung des deutschen Textes ist. Diese werden deutlich abgegrenzt (z. B. durch eine bestimmte Markierung wie "---" oder als separate Eingaben bereitgestellt).

**Aufgabe:** Das Verhalten des Agenten h\xE4ngt vom Eingabeformat ab:

* **Deutsche Eingabe (DE):** Der Agent identifiziert und erkl\xE4rt grammatikalische Fehler im deutschen Text, *ohne* Vokabel\xE4nderungen vorzuschlagen. Geben Sie f\xFCr jeden Fehler eine kurze Erkl\xE4rung an.  Fehlerhafte W\xF6rter sollen dabei *kursiv* hervorgehoben werden. Wenn der Text grammatikalisch korrekt ist, gibt der Agent nur "\u2705" aus.

* **Russische Eingabe (RU):** Der Agent \xFCbersetzt den russischen Text so gut wie m\xF6glich ins Deutsche. Die Ausgabe ist die deutsche \xDCbersetzung.

* **Russische und Deutsche Eingabe (RU & DE):** Der Agent analysiert den russischen Text als m\xF6gliche \xDCbersetzung des deutschen Textes. Er pr\xFCft sowohl die grammatikalische als auch die lexikalische Korrektheit. Bei Fehlern in der \xDCbersetzung (grammatikalisch oder lexikalisch) gibt der Agent eine kurze Erkl\xE4rung an. Fehlerhafte W\xF6rter in der *deutschen \xDCbersetzung* sollen dabei *kursiv* hervorgehoben werden. Wenn die \xDCbersetzung/der Satz korrekt ist, gibt der Agent nur "\u2705" aus.

**Ausgabeformat:**

Die Ausgabe des Agenten besteht *nur* aus:

* Fehlererkl\xE4rungen (f\xFCr DE- und RU&DE-Eingaben, wenn Fehler gefunden werden).
* Der deutschen \xDCbersetzung (f\xFCr RU-Eingaben).
* "\u2705" (wenn die Eingabe korrekt oder die \xDCbersetzung richtig ist).

Die Ausgabe soll kurz sein und alle zus\xE4tzlichen Kommentare oder Erkl\xE4rungen vermeiden, die nicht ausdr\xFCcklich angefordert werden. Es sind keine einleitenden oder abschlie\xDFenden Bemerkungen erforderlich. Halten Sie dieses strikte Ausgabeformat ein.

**Beispiele:**

<example>
<input>
\u041E\u043D \u0447\u0438\u0442\u0430\u0435\u0442 \u043A\u043D\u0438\u0433\u0443.
</input>
<output>
Er liest ein Buch.
</output>
</example>

<example>
<input>
Ich m\xF6chte ein Apfel.
</input>
<output>
Ich m\xF6chte *einen* Apfel.
"Apfel" is masculine, so the article should be "einen" (accusative) in this context.
</output>
</example>

<example>
<input>
Sie hat gesagt, dass sie m\xFCde ist.
\u041E\u043D\u0430 \u0441\u043A\u0430\u0437\u0430\u043B\u0430, \u0447\u0442\u043E \u043E\u043D\u0430 \u0443\u0441\u0442\u0430\u043B\u0430.
</input>
<output>
\u2705
</output>
</example>

<example>
<input>
\u041C\u044B \u043F\u043E\u0439\u0434\u0435\u043C \u0433\u0443\u043B\u044F\u0442\u044C \u0437\u0430\u0432\u0442\u0440\u0430.
</input>
<output>
Wir werden morgen spazieren gehen.
</output>
</example>

<example>
<input>
Ich habe kein Zeit.
</input>
<output>
Ich habe *keine* Zeit.
Das Wort "kein" sollte "keine" sein, da "Zeit" feminin ist (Nominativ oder Akkusativ).
</output>
</example>`};var F=class{constructor(n,t){this.settings=n;this.vault=t;this.genAI=null;this.model="gemini-2.0-flash-lite-preview-02-05";this.logFile="api-logs.md";this.chatSessions={};try{this.settings.apiProvider==="deepseek"||this.settings.apiProvider==="google"&&(this.genAI=new I(this.settings.googleApiKey)),this.ensureLogFile()}catch(i){console.error("Error initializing API service:",i),new ve.Notice(`Error initializing API service: ${i.message}`)}}async ensureLogFile(){try{await this.vault.adapter.exists(this.logFile)||await this.vault.create(this.logFile,`# API Logs

`)}catch(n){console.error("Error creating log file:",n)}}async appendToLog(n,t,i){try{let r=`
                  ## ${new Date().toISOString()}
                  ### Prompt:
                  \`\`\`
                  ${n}
                  \`\`\`

                  ### Response:
                  \`\`\`
                  ${t}
                  \`\`\`
                  ${i?`
### Error:
\`\`\`
${JSON.stringify(i,null,2)}
\`\`\`
`:""}
                  ---
                  `,o=this.vault.getAbstractFileByPath(this.logFile);if(o){let a=await this.vault.read(o);await this.vault.modify(o,a+r)}else{await this.ensureLogFile();let a=this.vault.getAbstractFileByPath(this.logFile);a&&await this.vault.modify(a,r)}}catch(s){console.error("Error appending to log:",s)}}async generateContent(n,t){try{let i=null,s=n+`
`+t;if(this.settings.apiProvider==="deepseek"){if(!this.settings.deepseekApiKey)throw new Error("DeepSeek API key not configured.");let o="https://api.deepseek.com/chat/completions",a={"Content-Type":"application/json",Authorization:`Bearer ${this.settings.deepseekApiKey}`},c=JSON.stringify({model:this.model,messages:[{role:"system",content:n},{role:"user",content:t}],stream:!1}),u=await fetch(o,{method:"POST",headers:a,body:c});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);i=(await u.json()).choices[0].message.content}else if(this.settings.apiProvider==="google"){if(!this.settings.googleApiKey)throw new Error("Google API key not configured.");this.genAI||(this.genAI=new I(this.settings.googleApiKey));let o={temperature:0,topP:.95,topK:64,maxOutputTokens:8192},a=n;if(!this.chatSessions[a]){let f=this.genAI.getGenerativeModel({model:this.model,systemInstruction:n});this.chatSessions[a]=f.startChat({generationConfig:o,history:[]})}i=(await this.chatSessions[a].sendMessage(t)).response.text()}else throw new Error("API provider not configured correctly.");let r=i===null?"":i;return await this.appendToLog(n,r),r}catch(i){throw await this.appendToLog(n,"",i),console.error("Error generating content:",i),new Error(i.message)}}async fetchTemplate(n){return this.generateContent(C.generate_dictionary_entry,n)}async determineInfinitiveAndEmoji(n){return this.generateContent(C.determine_infinitive_and_pick_emoji,n)}async makeBrackets(n){return this.generateContent(C.make_brackets,n)}async translateText(n){return this.generateContent(C.translate_text,n)}async translateRuToDe(n){return this.generateContent(C.translate_ru_to_de,n)}async checkRuDeTranslation(n){return this.generateContent(C.check_ru_de_translation,n)}};var U=require("obsidian"),D=class{constructor(n){this.vault=n}async appendToFile(n,t){try{let i=await this.vault.getAbstractFileByPath(n);if(!i||!(i instanceof U.TFile)){console.error(`File "${n}" not found.`);return}(await this.vault.read(i)).endsWith(`
`)||(t=`
`+t),await this.vault.append(i,t)}catch(i){throw console.error(`Failed to append to file ${n}: ${i}`),i}}async doesFileContainContent(n,t){let i=this.vault.getAbstractFileByPath(n);return!i||!(i instanceof U.TFile)?null:(await this.vault.read(i)).includes(t)}};var Ee=require("obsidian");var M=require("obsidian");async function P(e){var t;let n=(t=e.file)==null?void 0:t.name;return n?n.slice(0,-3):(new M.Notice("Current file is missing a title"),null)}async function b(e){let n=e.getSelection();return n||(new M.Notice("No text selected"),null)}async function G(e){var t;let n=(t=e.file)==null?void 0:t.name;return n||(new M.Notice("Current file is missing a title"),null)}async function V(e,n,t){var s;let i=await P(t);if(i)try{let r=await e.apiService.fetchTemplate(i);r&&((s=t==null?void 0:t.file)!=null&&s.path)&&await e.fileService.appendToFile(t.file.path,r)}catch(r){new Ee.Notice(`Error: ${r.message}`)}}var be=require("obsidian");async function Y(e,n,t){var s;let i=await P(t);if(i)try{let r=await e.apiService.determineInfinitiveAndEmoji(i);r&&(r=r.replace(/^\n+/,""),r=r.trim(),(s=t.file)!=null&&s.path&&await e.fileService.appendToFile(t.file.path,r+`
`))}catch(r){new be.Notice(`Error: ${r.message}`)}}var ye=require("obsidian");async function q(e,n,t){let i=await b(n);if(!i)return;let s=await G(t);if(s)try{if(t.file){let r=await e.app.vault.read(t.file),a=e.findHighestNumber(r)+1,c=await e.apiService.makeBrackets(i);if(c){let f=`${`[[${s}#^${a}|(q)]]`} ${c} ^${a}
`;n.replaceSelection(f)}}}catch(r){new ye.Notice(`Error: ${r.message}`)}}var _e=require("obsidian");async function W(e,n){let t=await b(n);if(t)try{let i=n.getCursor(),s=await e.apiService.translateText(t);s&&(n.replaceSelection(t+`

`+s+`
`),n.setCursor({line:i.line,ch:i.ch+t.length}))}catch(i){new _e.Notice(`Error: ${i.message}`)}}var Ce=require("obsidian");async function J(e,n,t){let i=await b(n);if(!i)return;let s=await G(t);if(s)try{if(t.file){let r=await e.app.vault.read(t.file),a=e.findHighestNumber(await r)+1,c=`[[${s}#^${a}|(q)]]`;await navigator.clipboard.writeText(`${i} ${c} 
`),n.replaceSelection(`${c} ${i} ^${a}
`)}}catch(r){new Ce.Notice(`Error: ${r.message}`)}}var ke=require("obsidian");async function Z(e,n){let t=await b(n);if(t)try{let i=await e.apiService.checkRuDeTranslation(t);i&&n.replaceSelection(t+`
`+i+`
`)}catch(i){new ke.Notice(`Error: ${i.message}`)}}var $=class extends m.Plugin{async onload(){try{await this.loadSettings(),console.log("Settings loaded:",this.settings),this.apiService=new F(this.settings,this.app.vault),this.fileService=new D(this.app.vault),this.addCommand({id:"backlink-all-to-current-file",name:"Add backlinks to the current file in all referenced files",editorCallback:async(t,i)=>{var f,w;let s=(f=i.file)==null?void 0:f.name;if(!i.file||!s){new m.Notice("Current file is missing a title");return}let{metadataCache:r,vault:o}=this.app,a=r.getFileCache(i.file),c=(w=a==null?void 0:a.links)!=null?w:[],u=[];for(let d of c){let l=d.link,g=r.getFirstLinkpathDest(l,i.file.path);g instanceof m.TFile?u.push({name:l,path:g.path}):u.push({name:l,path:null})}for(let d of u)try{let l,g=`[[${s.split(".")[0]}]]`;if(d.path)l=d.path;else{let L=`Worter/${d.name[0].toUpperCase()}`;o.getAbstractFileByPath(L)||await o.createFolder(L),l=`${L}/${d.name}.md`}await this.fileService.doesFileContainContent(l,g)||await this.fileService.appendToFile(l,`, ${g}`)}catch(l){new m.Notice(`Error processing link ${d.name}: ${l.message}`)}}}),this.addCommand({id:"fill-template",name:"Fill the template for the word in the title of the file",editorCallback:async(t,i)=>{await V(this,t,i)}}),this.addCommand({id:"get-infinitive-and-emoji",name:"Get infinitive form and emoji for current word",editorCallback:async(t,i)=>{await Y(this,t,i)}}),this.addCommand({id:"duplicate-selection",name:"Duplicate selected text and process with brackets",editorCallback:async(t,i)=>{await q(this,t,i)}}),this.addCommand({id:"translate-selection",name:"Translate selected text and show below",editorCallback:async t=>{await W(this,t)}}),this.addCommand({id:"format-selection-with-number",name:"Format selection with next number and source link",editorCallback:async(t,i)=>{await J(this,t,i)}}),this.addCommand({id:"translate-ru-to-de",name:"Translate Russian text to German",editorCallback:async t=>{let i=t.getSelection();if(!i){new m.Notice("No text selected");return}try{let s=await this.apiService.translateRuToDe(i);s&&t.replaceSelection(i+`
`+s+`
`)}catch(s){new m.Notice(`Error: ${s.message}`)}}}),this.addCommand({id:"check-ru-de-translation",name:"Check Russian-German translation",editorCallback:async t=>{await Z(this,t)}}),this.addSettingTab(new N(this.app,this))}catch(t){console.error("Error during plugin initialization:",t),new m.Notice(`Plugin failed to load: ${t.message}`)}}async loadSettings(){this.settings=Object.assign({},X,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}findHighestNumber(t){let i=t.match(/#\^(\d+)/g);if(!i)return 0;let s=i.map(r=>{let o=r.replace("#^","");return parseInt(o,10)});return Math.max(0,...s)}};
/*! Bundled license information:

@google/generative-ai/dist/index.mjs:
   (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@google/generative-ai/dist/index.mjs:
   (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
